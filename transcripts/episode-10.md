In questo episodio di Info Sec. Unplugged, ci siamo messi il cappello difensivo e abbiamo riflettuto su come disegnare una rete partendo da un presupposto realistico: una macchina, prima o poi, sarà compromessa. Progettiamo quindi le reti pensando al threat modeling, cioè assumendo che un nodo possa cadere sotto attacco e che la nostra architettura debba limitarne l’impatto. Questa prospettiva ci spinge a ridurre la superficie di rischio e a segmentare in modo intelligente.

Nel disegnare una rete, ci rendiamo conto che molte protezioni dipendono dal vendor: ad esempio, lo spanning tree non è tanto una questione di sicurezza quanto di performance, ma va comunque gestito con attenzione. Abbiamo discusso di come protocolli come CDP, LLDP o il Dynamic Trunk Protocol dovrebbero essere disabilitati sulle porte di accesso, che sono più esposte.

Una best practice che ci portiamo dietro da tempo è quella di limitare il numero di MAC address per porta: una misura semplice ma utile per mitigare i loop di rete e, incidentalmente, ridurre anche i rischi di saturazione delle tabelle o di esaurimento delle risorse DHCP. In passato, avevamo impostato un limite di cinque indirizzi per porta: uno per il telefono, uno per il PC e qualche margine per eventuali macchine virtuali. Così, lo switch accettava solo i primi cinque dispositivi registrati, scartando gli altri.

Da qui, abbiamo approfondito il tema delle protezioni di rete come il DHCP snooping, che serve a prevenire risposte malevole provenienti da porte non autorizzate — un problema tutt’altro che teorico, visto che basta un consulente con VMware e DHCP attivo per causare disastri. Abbiamo poi parlato di Dynamic ARP Inspection, utile per evitare ARP spoofing e impersonificazioni del gateway. Nonostante sia una tecnologia efficace, pochi la implementano davvero, perché richiede un’integrazione accurata con il DHCP e una configurazione complessa.

Siamo quindi passati al concetto di private VLAN, un approccio che consideriamo molto valido soprattutto nelle reti di accesso, dove il controllo fisico è limitato. In questi contesti, ci piace pensare alla rete come a una “terra di nessuno”, dove conviene impedire ai client di comunicare tra loro: devono poter parlare solo con il gateway. È una logica simile a quella del Wi-Fi, dove la separazione tra client è ormai comune.

La discussione ci ha portato a riflettere anche sul ruolo sempre più marginale della fonia tradizionale. Oggi molti usano softphone e sistemi di collaboration, quindi la vecchia rete voce è spesso solo un’eredità del passato. Le aziende più moderne la stanno già abbandonando.

Restano invece fondamentali la protezione e la detection a livello di gateway. Per noi, l’unico gateway possibile è un firewall con IPS attivo verso l’interno: se rileva uno scan interno, c’è un problema serio. Ci stiamo anche ispirando al concetto di network as a sensor, introdotto da Cisco: ogni nodo della rete, dagli switch agli endpoint, può diventare un sensore di sicurezza. Immaginiamo un futuro in cui ogni EDR raccolga anche piccole evidenze di rete — in questo modo, uno scan interno verrebbe segnalato da molti punti contemporaneamente, rendendo più difficile passare inosservati.

Abbiamo poi ricordato un esperimento passato: uno script scritto con Scapy per creare una sorta di IPS “aggressivo”. L’idea era semplice: se una macchina riceve un pacchetto SYN su una porta dove non offre servizi, significa che qualcuno la sta scandagliando. In tal caso, rispondeva con un SYN-ACK e, se la connessione veniva completata, l’IP veniva automaticamente inserito in blacklist e pubblicato. Era un sistema un po’ rude, ma efficace per individuare attività malevole, simile per certi versi a un honeypot. Analizzando gli IP bloccati, più della metà provenivano dagli Stati Uniti, seguiti da Cina e Russia.

Abbiamo chiuso la puntata con una riflessione: il mondo del Wi-Fi meriterebbe un approfondimento dedicato. È un contesto diverso, con protocolli propri e sfide uniche. Ci piacerebbe esplorarlo con un ospite esperto e magari testare in laboratorio alcune delle soluzioni discusse, per verificare cosa funziona davvero.
