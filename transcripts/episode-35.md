In questa puntata riprendiamo due fili lasciati aperti in precedenza. Da un lato vogliamo parlare di attacchi wireless e social engineering, dall’altro dell’uso della VPN come meccanismo forte di accesso amministrativo alle risorse del data center. Partiamo dal primo tema, guardando la rete Wi-Fi dal punto di vista di chi cerca di capire se esiste un modo per accedere a un’infrastruttura bersaglio.

Quando si parla di wireless, è naturale distinguere tra l’accesso a una porta fisica o a una porta esposta su Internet e quello che succede quando si tenta di sfruttare una rete Wi-Fi. Esiste una tecnica storica, in uso da più di vent’anni, che molti conoscono: mettersi in ascolto del traffico wireless con un’antenna adeguata e raccogliere alcuni pacchetti che le stazioni inviano mentre cercano un access point a cui collegarsi. Da lì, analizzando quei pacchetti, si tenta di ricavare informazioni utili per effettuare il cracking della credenziale. È la classica metodologia associata a WPA2.

Questa tecnica richiede però presenza fisica nel raggio della rete, tipicamente poche decine di metri, e il suo successo dipende fortemente dalla complessità della password. In ambienti maturi, dove le password sono robuste, spesso non porta a risultati concreti. Per questo negli anni si sono sviluppate tecniche più “furbe”, che non puntano solo sulla crittografia ma sfruttano il comportamento delle persone, combinato con quello dei protocolli di autenticazione wireless.

Qui entra in gioco il concetto di rogue device: un access point posizionato in modo fraudolento nei pressi della rete target. Una tecnica particolarmente efficace consiste nell’imitare il captive portal dell’azienda. La prima fase è di ricognizione: capire se l’organizzazione utilizza un captive portal, magari per gli ospiti o come meccanismo di fallback per utenti interni. È una situazione più comune di quanto si pensi, soprattutto in ambienti misti o con policy poco stringenti sugli endpoint.

Dal punto di vista tecnico, replicare un captive portal è relativamente semplice. Basta pubblicare lo stesso SSID e riprodurre la pagina di autenticazione, che spesso è solo HTML statico facilmente recuperabile. A quel punto l’attaccante può accettare qualsiasi credenziale inserita, concedere comunque l’accesso a Internet e, nel frattempo, collezionare username e password. Se il captive portal integra autenticazioni di terze parti, come Google, il danno può estendersi anche a quegli account.

Una volta che l’utente è collegato, tutto il traffico passa attraverso il rogue device. È possibile raccoglierlo, analizzarlo e persino modificarlo, ad esempio manipolando le risposte DNS e mettendosi in mezzo alle comunicazioni. Se il traffico è cifrato, l’utente potrebbe notare errori di certificato, ma questo richiede consapevolezza. E qui emerge un punto critico: se abituiamo gli utenti ad accettare certificati non validi o self-signed, stiamo di fatto eliminando una delle poche difese visibili che hanno.

Una variante di questo scenario è l’attacco evil twin. Anche qui si crea una rete Wi-Fi che imita quella ufficiale, ma si usano tecniche per disturbare i client e spingerli a collegarsi all’access point malevolo. A quel punto l’utente pensa di essere sulla rete aziendale e prova ad accedere ai servizi interni. Tutto quel traffico diventa osservabile e sfruttabile. In alcuni casi si riesce persino a ottenere credenziali valide, soprattutto se l’autenticazione avviene solo tramite username e password.

Quando invece è in uso anche l’autenticazione tramite certificato (machine authentication), il gioco diventa molto più difficile per l’attaccante. Non avere la chiave privata del dispositivo limita fortemente l’impatto dell’attacco. Rimane comunque una finestra temporale in cui il rogue access point può osservare e interagire con il device, finché l’utente non si accorge che qualcosa non funziona.

Tutto questo è possibile solo se il threat actor si trova fisicamente vicino e attiva una propria rete. Ed è qui che entra in gioco la detection. I nostri access point possono vedere altre reti che vengono pubblicate nello stesso spazio radio, ma distinguere quelle legittime da quelle malevole non è banale. In passato abbiamo visto sistemi che segnalavano qualsiasi SSID sconosciuto come “rogue”, producendo decine di allarmi inutili in contesti urbani. Serve quindi una gestione più intelligente, basata su inventari, correlazioni e comportamenti.

Il problema del wireless non si limita agli uffici. In ambito OT e IoT è ancora più evidente. Molti impianti industriali, sistemi fotovoltaici o macchine di produzione hanno access point integrati per la manutenzione, spesso con password di default o addirittura senza protezione. In alcuni casi queste reti di servizio sono instradate direttamente sulla rete aziendale, creando un punto di accesso critico e spesso dimenticato.

Il secondo tema che affrontiamo riguarda invece l’accesso amministrativo ai data center. Un’architettura che abbiamo visto raramente ma che consideriamo molto solida prevede l’uso obbligatorio di una VPN per qualsiasi attività amministrativa. In questo modello, l’identità dell’amministratore viene validata a monte, tipicamente dal firewall, e diventa il perno di tutte le successive autorizzazioni.

Siamo particolarmente fan dei design out-of-band: reti e accessi separati, fisicamente e logicamente, dedicati alla gestione dell’infrastruttura. L’idea è semplice ma potente: la porta con cui amministriamo i sistemi non deve essere la stessa che usiamo per erogare i servizi. In caso di disastro, quell’accesso deve funzionare anche quando tutto il resto è giù.

Questo implica separare reti, credenziali e, spesso, anche i sistemi di autenticazione. Può significare avere switch dedicati, firewall separati e account locali che non dipendono da directory centrali. Sono accessi che non dovrebbero mai essere usati nella normalità, e proprio per questo diventano ottimi indicatori di anomalia: se qualcuno li utilizza senza una manutenzione pianificata, è un segnale forte per il SOC.

Lo stesso vale per gli accessi preparati per l’incident response. Durante l’onboarding di un servizio di risposta agli incidenti, questi accessi devono essere definiti, testati e documentati. In caso contrario, durante una crisi si perde tempo prezioso a capire come entrare in un’infrastruttura già compromessa.

Nessuna infrastruttura nasce perfetta. Queste conversazioni servono proprio a far emergere i pezzi mancanti, a prendere consapevolezza dei rischi e ad aggiungere, un passo alla volta, nuovi livelli di resilienza. Ogni episodio aggiunge qualche mattoncino in più, ed è così che si costruiscono architetture più solide nel tempo.
