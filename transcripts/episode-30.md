In questa puntata abbiamo deciso di affrontare il tema della postura di sicurezza partendo da uno dei controlli dell'Annex A della ISO/IEC 27001 che, per noi, è tra i più complessi da gestire davvero: la gestione delle configurazioni. Ci interessa parlarne non solo in chiave tecnica, ma anche dal punto di vista della compliance, perché è proprio nella distanza tra questi due mondi che spesso nascono le lacune più evidenti.

Partiamo quindi dal campo, da ciò che vediamo davvero durante i security test. Quando una configurazione non è gestita, lo scenario più frequente — e allo stesso tempo più disarmante — è ritrovare dispositivi di ogni tipo con impostazioni di default: network appliance, endpoint, sistemi operativi, stampanti. Molti di questi arrivano in azienda come escono di fabbrica e lì rimangono, con configurazioni minime giusto per renderli utilizzabili, ma senza nessun hardening.

Dal punto di vista offensivo, questo per noi significa trovarci davanti a opportunità immediate. Per esempio, su apparati di rete capita ancora di vedere SNMP in default, che espone una quantità enorme di informazioni utili alla mappatura dell'infrastruttura. A volte troviamo addirittura dump di configurazioni lasciati in share accessibili anche a utenti a basso privilegio, con dentro hash di password amministrative o dettagli precisi su come è segmentata la rete. Basta recuperarli, caricarli su un tool di cracking con una GPU decente e provare: molto spesso quelle password non sono particolarmente robuste.

Poi ci sono i casi ancora più incredibili: accessi alle porte seriali degli apparati non protetti da credenziali, configurazioni di admin locale lasciate volutamente deboli “tanto si usa il RADIUS”, oppure le stampanti — un classico — dove troviamo credenziali default tipo admin-admin. E ricordiamolo: le stampanti di oggi sono Linux embedded, con disco, log, buffer e spesso anche repository di scansioni e documenti stampati. Una miniera d’oro per un attaccante: informazioni sensibili, materiale per social engineering, un punto di appoggio persistente e silenzioso dentro la rete.

Durante i test, questa leggerezza nella gestione delle configurazioni è quasi sempre la prima strada che percorriamo. Non tanto per un vezzo offensivo, quanto perché è la strada che fa meno rumore. Sfruttare vulnerabilità è possibile, certamente, ma scatena allarmi; usare una default password su una stampante o installare un’applicazione tramite Microsoft Store — spesso ancora attivo nonostante l’organizzazione creda di averlo disabilitato — è molto più silenzioso. Capita che le policy di hardening non funzionino davvero, o che funzionino solo parzialmente, perché nessuno verifica nell’operatività la loro efficacia reale.

Tutto questo ci porta a un punto fondamentale: fare hardening è un conto, gestirlo è un altro. Molte aziende si ritrovano con ambienti eterogenei, sistemi Windows di versioni diverse, Mac, dispositivi di rete multivendor. Ogni combinazione richiede un template diverso, test dedicati, monitoraggio continuo. E già qui, da un punto di vista organizzativo, il lavoro sembra titanico.

Ma il vero problema arriva quando si tenta di mantenere questi template aggiornati nel tempo. Se qualcosa cambia in modo non previsto, se un’impostazione non viene applicata correttamente, se un nuovo elemento entra in azienda senza passare dal processo definito… tutto rischia di sfuggire di mano. È impossibile farlo a mano, ed è altrettanto impossibile scrivere procedure operative “in linguaggio naturale” che pretendano di standardizzare tutto. Servono strumenti e serve automazione.

Lo diciamo da tempo: senza un framework che permetta di definire le configurazioni in modo strutturato, testarle, applicarle, verificarle e correggerle, questo controllo della ISO 27001 non è realistico. Che sia una CMDB, un file YAML o un sistema più evoluto, dobbiamo avere un punto di verità unico e leggibile, un formato testuale che permetta di capire facilmente cosa è cambiato e se il cambiamento è autorizzato. E sopra questo, dobbiamo costruire automazione: provisioning, verifica, remediazione. Non è un’opzione, è l’unico modo per uscire dalla logica artigianale delle configurazioni fatte “una tantum”.

Sappiamo che tutto questo può spaventare: quando ci troviamo davanti a migliaia di apparati da gestire, il solo pensiero di standardizzarne la configurazione sembra impossibile. Ma, come diciamo sempre, l’elefante si mangia un pezzo alla volta. Non serve partire da tutto: basta iniziare da ciò che ha più impatto, come le workstation, e costruire gradualmente un processo che sia replicabile.

E alla fine, se un domani in un test vi segnaliamo una misconfiguration, poter distribuire rapidamente una correzione a tutta l’infrastruttura diventerà una questione di minuti — non di settimane. Ed è qui che si vede la differenza tra un ambiente che “fa hardening” e uno che “gestisce le configurazioni”.

Con questa consapevolezza arriviamo alla fine della puntata: il lavoro è enorme, sì, ma non impossibile. Serve metodo, serve automazione e serve volontà di cambiare approccio. Una volta imboccato il sentiero, tutto diventa più gestibile.
